<!-- Launch velocity smoother TODO make sure that this works w/ flaky wifi -->
<node name="smoother" pkg="yocs_velocity_smoother" type="yocs_velocity_smoother" output="screen">
  <remap from="raw_cmd_vel" to="cmd_vel" /> <!-- Input is cmd_vel -->
  <remap from="odometry" to="odom" /> <!-- Feedback from odometry -->
  <rosparam>
    speed_lim_v: 0.8
    speed_lim_w: 5.4
    accel_lim_v: 1.0
    accel_lim_w: 2.0
    frequency: 20.0
    decel_factor: 1.5
    robot_feedback: 1 # 0=none, 1=odometry, 2=cmd_vel
  </rosparam>
</node>

<!-- Launch base controller -->
<node name="driver" pkg="ca_driver" type="ca_driver" output="screen">
  <remap from="cmd_vel" to="smooth_cmd_vel" /> <!-- Input is smooth_cmd_vel -->
  <param name="~loop_hz" value="30" />
  <param name="~dev" value="/dev/ttyUSB0" />
  <param name="~publish_tf" value="true"/>
  <param name="~create_1" value="false" />
</node>

<!-- Load robot description -->
<include file="$(find ca_description)/launch/create_2.launch"/>

<!-- Static transform to link base_footprint and base_link; TODO figure out the URDF bug -->
<!-- <node name="footprint2link" pkg="tf" type="static_transform_publisher" args="0 0 0.017 0 0 0 base_footprint base_link 100" /> -->

<!-- Monitor the battery -->
<node name="batteryMon" pkg="rodeobot" type="battery_monitor" output="screen" />

<!-- Run safety checks TODO -->

